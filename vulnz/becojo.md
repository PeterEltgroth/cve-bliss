# alpine-gitleaks

Dockerfile: https://github.com/gitleaks/gitleaks/blob/97dbe1ef0969f6162e061a5418063f19ed729497/Dockerfile

```sh
$ grype gitleaks
 ✔ Vulnerability DB                [no update available]
 ✔ Loaded image                                                                                                                                                           gitleaks:latest
 ✔ Parsed image                                                                                                   sha256:a141483555e1124c9cbd5d31ff5a76ee7a7197723bfaf40b2701462aa69f4812
 ✔ Cataloged contents                                                                                                    ea7b11e657797293b06c72165b7f70ceacc190c02b564faa42b80437185f9543
   ├── ✔ Packages                        [65 packages]
   ├── ✔ File digests                    [393 files]
   ├── ✔ File metadata                   [393 locations]
   └── ✔ Executables                     [85 executables]
 ✔ Scanned for vulnerabilities     [4 vulnerability matches]
   ├── by severity: 0 critical, 2 high, 1 medium, 0 low, 0 negligible (1 unknown)
   └── by status:   0 fixed, 4 not-fixed, 0 ignored
NAME          INSTALLED  FIXED-IN  TYPE       VULNERABILITY   SEVERITY
nghttp2-libs  1.58.0-r0            apk        CVE-2024-28182  Medium
stdlib        go1.21.13            go-module  CVE-2024-34158  High
stdlib        go1.21.13            go-module  CVE-2024-34156  High
stdlib        go1.21.13            go-module  CVE-2024-34155  Unknown
```

# chainguard-gitleaks

```diff
diff --git a/Dockerfile b/Dockerfile
index f258607..0dff6db 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,10 +1,10 @@
-FROM golang:1.21 AS build
+FROM cgr.dev/chainguard/go:latest@sha256:a3b4696e85298d53baf4732d134894d951cdfd37f5c555d5efe0f5e9dce0f911 AS build
 WORKDIR /go/src/github.com/zricethezav/gitleaks
 COPY . .
 RUN VERSION=$(git describe --tags --abbrev=0) && \
 CGO_ENABLED=0 go build -o bin/gitleaks -ldflags "-X="github.com/zricethezav/gitleaks/v8/cmd.Version=${VERSION}
 
-FROM alpine:3.19
+FROM chainguard/wolfi-base:latest@sha256:7574456f268bc839ac78828865087c04a4297ca226b0eb5d051d4222e7690081
 RUN apk add --no-cache bash git openssh-client
 COPY --from=build /go/src/github.com/zricethezav/gitleaks/bin/* /usr/bin/
```

```sh
$ grype gitleaks-chainguard                                                                                                    
 ✔ Vulnerability DB                [no update available]
 ✔ Loaded image                                                                                                                                                gitleaks-chainguard:latest
 ✔ Parsed image                                                                                                   sha256:1e45e7fcc0ffedc4927fa9c63c48a365f3bf691d63037f376f619ea427f85119
 ✔ Cataloged contents                                                                                                    7305c217c1a04cfc51d658175d0846b878043f3d50d7b66b8cce4f3acf21d188
   ├── ✔ Packages                        [66 packages]
   ├── ✔ File digests                    [545 files]
   ├── ✔ File metadata                   [545 locations]
   └── ✔ Executables                     [78 executables]
 ✔ Scanned for vulnerabilities     [0 vulnerability matches]
   ├── by severity: 0 critical, 0 high, 0 medium, 0 low, 0 negligible
   └── by status:   0 fixed, 0 not-fixed, 0 ignored
No vulnerabilities found
```